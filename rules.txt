table ip filter {
	chain INPUT {
		type filter hook input priority 0; policy drop;
		ct state new tcp flags & (fin | syn | rst | ack) != syn counter packets 0 bytes 0 drop
		ct state invalid counter packets 7 bytes 316 drop
		ip saddr SRC ADDR HERE ct state established,related counter packets 0 bytes 0 accept
		ct state established,related counter packets 3761 bytes 3681379 accept
		iifname != "lo" ip saddr 127.0.0.0/8 counter packets 0 bytes 0 drop
		iifname "lo" ip saddr 127.0.0.1 counter packets 304 bytes 22886 accept
		iifname "INERFACE GOES HERE" counter packets 340 bytes 26436 log prefix "BANDWIDTH_IN:"
		iifname "INERFACE GOES HERE" ip protocol tcp ip saddr SRC ADDR HERE ip daddr DST ADDR HERE counter packets 0 bytes 0 drop
		iifname "INERFACE GOES HERE" ip protocol udp ip saddr SRC ADDR HERE ip daddr DST ADDR HERE counter packets 6 bytes 2622 drop
		ip daddr 224.0.0.0/4 counter packets 63 bytes 4721 drop
		ct state new icmp type echo-request counter packets 0 bytes 0 log prefix "IPTABLES: "
		tcp flags & (fin | syn | rst | psh | ack | urg) == fin | syn | rst | ack counter packets 0 bytes 0 reject
		tcp flags & (fin | syn | rst | psh | ack | urg) == fin | syn | rst | ack counter packets 0 bytes 0 log prefix "IPTABLES: "
		tcp flags & (fin | syn) == fin | syn counter packets 0 bytes 0 reject
		tcp flags & (fin | syn) == fin | syn counter packets 0 bytes 0 log prefix "IPTABLES: "
		tcp flags & (syn | rst) == syn | rst counter packets 0 bytes 0 reject
		tcp flags & (syn | rst) == syn | rst counter packets 0 bytes 0 log prefix "IPTABLES: "
		tcp flags & (fin | syn | rst | psh | ack | urg) == fin | syn | rst | psh | ack | urg counter packets 0 bytes 0 reject
		tcp flags & (fin | syn | rst | psh | ack | urg) == fin | syn | rst | psh | ack | urg counter packets 0 bytes 0 log prefix "IPTABLES: "
		tcp flags & (fin | syn | rst | psh | ack | urg) == 0x0 counter packets 0 bytes 0 reject
		tcp flags & (fin | syn | rst | psh | ack | urg) == 0x0 counter packets 0 bytes 0 log prefix "IPTABLES: "
		icmp type address-mask-request counter packets 0 bytes 0 reject
		icmp type address-mask-request counter packets 0 bytes 0 log prefix "IPTABLES: "
		icmp type timestamp-request counter packets 0 bytes 0 reject
		icmp type timestamp-request counter packets 0 bytes 0 log prefix "IPTABLES: "
		iifname "INERFACE GOES HERE" ip daddr DST ADDR HERE ct state established,related counter packets 0 bytes 0 accept
		iifname "INERFACE GOES HERE" ip saddr NETWORK ADDR HERE ip daddr DST ADDR HERE ct state established,related counter packets 0 bytes 0 accept
		iifname "INERFACE GOES HERE" udp dport domain counter packets 0 bytes 0 accept
		iifname "INERFACE GOES HERE" tcp dport domain counter packets 0 bytes 0 accept
		iifname "INERFACE GOES HERE" ip daddr DST ADDR HERE tcp dport 3128 ct state established,related counter packets 0 bytes 0 accept
		iifname "INERFACE GOES HERE" ip daddr DST ADDR HERE udp dport 3128 ct state established,related counter packets 0 bytes 0 accept
		iifname "INERFACE GOES HERE" ip daddr DST ADDR HERE tcp dport { http, https } ct state established,related counter packets 0 bytes 0 accept
		iifname "INERFACE GOES HERE" ip daddr DST ADDR HERE udp dport { http, https } ct state established,related counter packets 0 bytes 0 accept
		iifname "INERFACE GOES HERE" ip saddr NETWORK ADDR HERE ip daddr DST ADDR HERE tcp dport { netbios-ssn, microsoft-ds } ct state established,related counter packets 0 bytes 0 accept
		iifname "INERFACE GOES HERE" ip saddr NETWORK ADDR HERE ip daddr DST ADDR HERE udp dport { netbios-ns, netbios-dgm } ct state established,related counter packets 0 bytes 0 accept
		iifname "INERFACE GOES HERE" ip saddr NETWORK ADDR HERE ip daddr DST ADDR HERE tcp dport 2202 ct state established,related counter packets 0 bytes 0 accept
		iifname "INERFACE GOES HERE" ip saddr NETWORK ADDR HERE ip daddr DST ADDR HERE udp dport 2202 ct state established,related counter packets 0 bytes 0 accept
		iifname "INERFACE GOES HERE" ip saddr NETWORK ADDR HERE ip daddr DST ADDR HERE tcp dport webmin ct state established,related counter packets 0 bytes 0 accept
		iifname "INERFACE GOES HERE" ip saddr NETWORK ADDR HERE ip daddr DST ADDR HERE udp dport webmin ct state established,related counter packets 0 bytes 0 accept
		ct state new tcp dport auth tcp flags & (fin | syn | rst | ack) == syn counter packets 0 bytes 0 reject with tcp reset
		limit rate 1/second burst 100 packets counter packets 271 bytes 19093 log prefix "IPTABLES: "
		ct state invalid counter packets 0 bytes 0 drop
		counter packets 271 bytes 19093 drop
	}

	chain FORWARD {
		type filter hook forward priority 0; policy accept;
		oifname "INERFACE GOES HERE" counter packets 0 bytes 0 log prefix "BANDWIDTH_OUT:"
		iifname "INERFACE GOES HERE" counter packets 0 bytes 0 log prefix "BANDWIDTH_IN:"
		ct state new tcp flags & (fin | syn | rst | ack) != syn counter packets 0 bytes 0 drop
		ct state invalid counter packets 0 bytes 0 drop
		counter packets 0 bytes 0 drop
	}

	chain OUTPUT {
		type filter hook output priority 0; policy accept;
		ct state invalid counter packets 0 bytes 0 drop
		tcp flags & (fin | syn | rst | ack) != syn ct state new counter packets 0 bytes 0 drop
		oifname "INERFACE GOES HERE" counter packets 2864 bytes 279356 log prefix "BANDWIDTH_OUT:"
		oifname "INERFACE GOES HERE" ip protocol tcp ip saddr SRC ADDR HERE ip daddr SRC ADDR HERE counter packets 0 bytes 0 drop
		oifname "INERFACE GOES HERE" ip protocol udp ip saddr SRC ADDR HERE ip daddr SRC ADDR HERE counter packets 0 bytes 0 drop
		oifname != "lo" ip saddr 127.0.0.0/8 counter packets 0 bytes 0 drop
		oifname "lo" counter packets 658 bytes 61684 accept
		oifname "INERFACE GOES HERE" ip saddr SRC ADDR HERE ct state established,related counter packets 2408 bytes 231059 accept
		oifname "INERFACE GOES HERE" tcp dport { http, https } ct state established,related counter packets 0 bytes 0 accept
		oifname "INERFACE GOES HERE" udp dport domain counter packets 268 bytes 20734 accept
		oifname "INERFACE GOES HERE" tcp dport domain counter packets 0 bytes 0 accept
		oifname "INERFACE GOES HERE" udp sport ntp udp dport ntp counter packets 0 bytes 0 accept
		oifname "INERFACE GOES HERE" ct state established,related counter packets 0 bytes 0 accept
		oifname "INERFACE GOES HERE" ct state established,related counter packets 0 bytes 0 accept
		oifname "INERFACE GOES HERE" tcp sport 3128 ct state established,related counter packets 0 bytes 0 accept
		oifname "INERFACE GOES HERE" udp sport 3128 ct state established,related counter packets 0 bytes 0 accept
		oifname "INERFACE GOES HERE" ip saddr SRC ADDR HERE tcp sport 51413 counter packets 0 bytes 0 accept
		oifname "INERFACE GOES HERE" ip saddr SRC ADDR HERE udp sport 51413 counter packets 0 bytes 0 accept
		oifname "INERFACE GOES HERE" ip saddr SRC ADDR HERE ip daddr NETWORK ADDR HERE tcp dport { netbios-ssn, microsoft-ds } ct state established,related counter packets 0 bytes 0 accept
		oifname "INERFACE GOES HERE" ip saddr SRC ADDR HERE ip daddr NETWORK ADDR HERE udp dport { netbios-ns, netbios-dgm } ct state established,related counter packets 0 bytes 0 accept
		oifname "INERFACE GOES HERE" ip saddr SRC ADDR HERE ip daddr NETWORK ADDR HERE tcp dport 2202 ct state established,related counter packets 0 bytes 0 accept
		oifname "INERFACE GOES HERE" ip saddr SRC ADDR HERE ip daddr NETWORK ADDR HERE udp dport 2202 ct state established,related counter packets 0 bytes 0 accept
		oifname "INERFACE GOES HERE" ip saddr SRC ADDR HERE ip daddr NETWORK ADDR HERE tcp dport 6600 ct state established,related counter packets 0 bytes 0 accept
		oifname "INERFACE GOES HERE" ip saddr SRC ADDR HERE ip daddr NETWORK ADDR HERE udp dport 6600 ct state established,related counter packets 0 bytes 0 accept
		oifname "INERFACE GOES HERE" ip saddr SRC ADDR HERE ip daddr NETWORK ADDR HERE tcp dport webmin ct state established,related counter packets 0 bytes 0 accept
		oifname "INERFACE GOES HERE" ip saddr SRC ADDR HERE ip daddr NETWORK ADDR HERE udp dport webmin ct state established,related counter packets 0 bytes 0 accept
	}
}
table ip nat {
	chain PREROUTING {
		type nat hook prerouting priority 0; policy accept;
		iifname "INERFACE GOES HERE" tcp dport http counter packets 0 bytes 0 dnat to 10.0.0.11:3128
		iifname "INERFACE GOES HERE" tcp dport https counter packets 0 bytes 0 dnat to 10.0.0.11:3128
	}

	chain INPUT {
		type nat hook input priority 0; policy accept;
	}

	chain OUTPUT {
		type nat hook output priority 0; policy accept;
	}

	chain POSTROUTING {
		type nat hook postrouting priority 0; policy accept;
	}
}
table ip mangle {
	chain PREROUTING {
		type filter hook prerouting priority 0; policy accept;
	}

	chain INPUT {
		type filter hook input priority 0; policy accept;
	}

	chain FORWARD {
		type filter hook forward priority 0; policy accept;
	}

	chain OUTPUT {
		type filter hook output priority 0; policy accept;
	}

	chain POSTROUTING {
		type filter hook postrouting priority 0; policy accept;
	}
}
table ip6 filter {
	chain INPUT {
		type filter hook input priority 0; policy drop;
		iifname != "lo" ip6 saddr ::1 counter packets 0 bytes 0 drop
		iifname "lo" ip6 saddr ::1 counter packets 24 bytes 1284 accept
		iifname "lo" counter packets 0 bytes 0 accept
		ct state new tcp flags & (fin | syn | rst | ack) != syn counter packets 16 bytes 1743 drop
		ct state invalid counter packets 57 bytes 6488 drop
		ip6 saddr ipV6 ADDR HERE ct state established,related counter packets 0 bytes 0 accept
		ip6 saddr ipV6 ADDR HERE counter packets 0 bytes 0 accept
		ct state established,related counter packets 4 bytes 384 accept
		counter packets 86 bytes 12672 accept
		ip6 saddr fe80::/64 counter packets 0 bytes 0 accept
		iifname "INERFACE GOES HERE" counter packets 0 bytes 0 accept
		iifname "INERFACE GOES HERE" tcp dport { http, https } ct state established,related counter packets 0 bytes 0 accept
		iifname "INERFACE GOES HERE" udp dport { http, https } ct state established,related counter packets 0 bytes 0 accept
		iifname "INERFACE GOES HERE" ip6 saddr 2001:4860:4860::8888 ip6 daddr ipV6 ADDR HERE udp dport mdns counter packets 0 bytes 0 accept
		iifname "INERFACE GOES HERE" ip6 saddr 2001:4860:4860::8888 ip6 daddr ipV6 ADDR HERE tcp dport mdns counter packets 0 bytes 0 accept
		iifname "INERFACE GOES HERE" ip6 saddr 2001:4860:4860::8844 ip6 daddr ipV6 ADDR HERE udp dport mdns counter packets 0 bytes 0 accept
		iifname "INERFACE GOES HERE" ip6 saddr 2001:4860:4860::8844 ip6 daddr ipV6 ADDR HERE tcp dport mdns counter packets 0 bytes 0 accept
		iifname "INERFACE GOES HERE" ip6 saddr fe80::/64 tcp dport 2202 counter packets 0 bytes 0 accept
		ip6 saddr fe80::/64 icmpv6 type destination-unreachable counter packets 0 bytes 0 accept
		ip6 saddr fe80::/64 icmpv6 type packet-too-big counter packets 0 bytes 0 accept
		ip6 saddr fe80::/64 icmpv6 type time-exceeded counter packets 0 bytes 0 accept
		ip6 saddr fe80::/64 icmpv6 type parameter-problem counter packets 0 bytes 0 accept
		ip6 saddr fe80::/64 icmpv6 type nd-router-solicit counter packets 0 bytes 0 accept
		ip6 saddr fe80::/64 icmpv6 type nd-router-advert counter packets 0 bytes 0 accept
		ip6 saddr fe80::/64 icmpv6 type nd-neighbor-solicit counter packets 0 bytes 0 accept
		ip6 saddr fe80::/64 icmpv6 type nd-neighbor-advert counter packets 0 bytes 0 accept
		ip6 saddr fe80::/64 icmpv6 type nd-redirect counter packets 0 bytes 0 accept
		icmpv6 type echo-request counter packets 0 bytes 0 jump ICMPFLOOD
		tcp flags & (fin | syn | rst | psh | ack | urg) == fin | syn | rst | ack counter packets 0 bytes 0 reject
		tcp flags & (fin | syn) == fin | syn counter packets 0 bytes 0 reject
		tcp flags & (syn | rst) == syn | rst counter packets 0 bytes 0 reject
		tcp flags & (fin | syn | rst | psh | ack | urg) == fin | syn | rst | psh | ack | urg counter packets 0 bytes 0 reject
		tcp flags & (fin | syn | rst | psh | ack | urg) == 0x0 counter packets 0 bytes 0 reject
		counter packets 0 bytes 0 drop
	}

	chain FORWARD {
		type filter hook forward priority 0; policy drop;
		counter packets 0 bytes 0 drop
	}

	chain OUTPUT {
		type filter hook output priority 0; policy accept;
		ct state new tcp flags & (fin | syn | rst | ack) != syn counter packets 40 bytes 2820 drop
		ct state invalid counter packets 0 bytes 0 drop
		ip6 saddr ipV6 ADDR HERE counter packets 9 bytes 704 accept
		oifname "lo" ip6 saddr ::1 counter packets 24 bytes 1284 accept
		oifname "lo" counter packets 0 bytes 0 accept
		oifname "INERFACE GOES HERE" ip6 saddr ipV6 ADDR HERE udp sport mdns counter packets 0 bytes 0 accept
		oifname "INERFACE GOES HERE" ip6 saddr ipV6 ADDR HERE tcp sport mdns counter packets 0 bytes 0 accept
		oifname "INERFACE GOES HERE" tcp dport { http, https } ct state established,related counter packets 0 bytes 0 accept
		oifname "INERFACE GOES HERE" udp dport { http, https } ct state established,related counter packets 0 bytes 0 accept
		oifname "INERFACE GOES HERE" tcp dport { http, https } ct state established,related counter packets 0 bytes 0 accept
		oifname "INERFACE GOES HERE" udp dport domain counter packets 0 bytes 0 accept
		oifname "INERFACE GOES HERE" tcp dport domain counter packets 0 bytes 0 accept
		oifname "INERFACE GOES HERE" udp sport ntp udp dport ntp counter packets 0 bytes 0 accept
		oifname "INERFACE GOES HERE" ct state established,related counter packets 0 bytes 0 accept
		oifname "INERFACE GOES HERE" ct state established,related counter packets 0 bytes 0 accept
		oifname "INERFACE GOES HERE" tcp sport 3128 ct state established,related counter packets 0 bytes 0 accept
		oifname "INERFACE GOES HERE" udp sport 3128 ct state established,related counter packets 0 bytes 0 accept
		oifname "INERFACE GOES HERE" ip6 saddr ipV6 ADDR HERE tcp sport 51413 counter packets 0 bytes 0 accept
		oifname "INERFACE GOES HERE" ip6 saddr ipV6 ADDR HERE udp sport 51413 counter packets 0 bytes 0 accept
		oifname "INERFACE GOES HERE" ip6 saddr ipV6 ADDR HERE ip6 daddr ipV6 NETWORK ADDR HERE tcp dport { netbios-ssn, microsoft-ds } ct state established,related counter packets 0 bytes 0 accept
		oifname "INERFACE GOES HERE" ip6 saddr ipV6 ADDR HERE ip6 daddr ipV6 NETWORK ADDR HERE udp dport { netbios-ns, netbios-dgm } ct state established,related counter packets 0 bytes 0 accept
		oifname "INERFACE GOES HERE" ip6 saddr ipV6 ADDR HERE ip6 daddr ipV6 NETWORK ADDR HERE tcp dport 2202 ct state established,related counter packets 0 bytes 0 accept
		oifname "INERFACE GOES HERE" ip6 saddr ipV6 ADDR HERE ip6 daddr ipV6 NETWORK ADDR HERE udp dport 2202 ct state established,related counter packets 0 bytes 0 accept
		oifname "INERFACE GOES HERE" ip6 saddr ipV6 ADDR HERE ip6 daddr ipV6 NETWORK ADDR HERE tcp dport webmin ct state established,related counter packets 0 bytes 0 accept
		oifname "INERFACE GOES HERE" ip6 saddr ipV6 ADDR HERE ip6 daddr ipV6 NETWORK ADDR HERE udp dport webmin ct state established,related counter packets 0 bytes 0 accept
		oifname "INERFACE GOES HERE" ct state established,related counter packets 0 bytes 0 accept
		counter packets 7 bytes 480 accept
	}

	chain ICMPFLOOD {
	}
}
table ip6 nat {
	chain PREROUTING {
		type nat hook prerouting priority 0; policy accept;
	}

	chain INPUT {
		type nat hook input priority 0; policy accept;
	}

	chain OUTPUT {
		type nat hook output priority 0; policy accept;
	}

	chain POSTROUTING {
		type nat hook postrouting priority 0; policy accept;
	}
}
table ip6 mangle {
	chain PREROUTING {
		type filter hook prerouting priority 0; policy accept;
	}

	chain INPUT {
		type filter hook input priority 0; policy accept;
	}

	chain FORWARD {
		type filter hook forward priority 0; policy accept;
	}

	chain OUTPUT {
		type filter hook output priority 0; policy accept;
	}

	chain POSTROUTING {
		type filter hook postrouting priority 0; policy accept;
	}
}
